import{d as E,o as S,c as k,b as g,r as q,x,y as T,z as $,A as N,f as L,w as y,B as J,C as X,u as f,e as C,D as I,E as D,G as Z,q as M,h as U,s as Q,H as ee,F as te,I as ne,a as se,i as oe}from"./vendor.cfaae494.js";import{B as ae}from"./Button.40b336c5.js";import{u as H,Z as F,N as j,_ as ie}from"./index.21dff4f4.js";import{u as P,B as p}from"./board.60ad6bde.js";var V="/pacman-resolver/assets/wall.d1eeac38.png",K="/pacman-resolver/assets/street.a943c8c6.png",W="/pacman-resolver/assets/food.37631a6a.png",G="/pacman-resolver/assets/pacmon.cddf7029.png",re="/pacman-resolver/assets/remove.b16c524a.png";const le={class:"absolute flex justify-center items-center w-full h-full transform -rotate-45 text-2xl select-none"},O=E({emits:["click"],setup(h,{emit:s}){return(n,u)=>(S(),k("div",{class:"relative cursor-pointer transition hover:bg-gray-800",onClick:u[0]||(u[0]=v=>s("click"))},[g("div",le,[q(n.$slots,"default")])]))}}),ce=({element:h,initialVisible:s,cantOpenContextMenu:n})=>{const u=x(s||!1),v=x({top:0,left:0}),e=T(()=>{const{top:t,left:r}=v.value;return{top:`${t}px`,left:`${r}px`}}),c=t=>{const r=h.value,i=r.clientHeight,w=r.clientWidth;t.top+i>=window.innerHeight&&(t.top-=i),t.left+w>=window.innerWidth&&(t.left-=w),v.value=t},a=()=>u.value=!1,o=t=>{if(t.stopPropagation(),!u.value)return;const r=t.target;!h.value.contains(r)&&a()},l=async t=>{if(t.preventDefault(),n())return;const r={top:t.pageY,left:t.pageX};u.value&&a(),await N(),u.value=!0,c(r)};return window.addEventListener("click",o),window.addEventListener("contextmenu",l),$(()=>window.removeEventListener("contextmenu",l)),{isVisible:u,position:v,positionStyle:e,closeContextMenu:a}},de={class:"relative select-none"},ue={class:"border-2 border-blue-300 bg-gray-900 rounded-full w-52 h-52 grid grid-cols-2 grid-rows-2 transform rotate-45 overflow-hidden shadow-xl shadow-gray-900 divide-gray-700 divide-x divide-y"},me=g("img",{src:V,class:"w-9 h-9"},null,-1),fe=g("img",{src:K,class:"w-9 h-9"},null,-1),pe=g("img",{src:W,class:"w-9 h-9"},null,-1),ve=g("img",{src:G,class:"w-9 h-9"},null,-1),ge=g("div",{class:"rounded-full w-full h-full bg-gray-800 cursor-pointer flex justify-center items-center text-2xl hover:bg-gray-700"},[g("img",{src:re,class:"w-7 h-7"})],-1),he=[ge],we=E({props:{visible:null},setup(h){const s=h,n=P(),u=H(),v=x(null),{isVisible:e,positionStyle:c,closeContextMenu:a}=ce({element:v,initialVisible:s.visible,cantOpenContextMenu:()=>n.isAnimating||n.isAnimatingInitialAnimation||!n.hasSelectedCoordinate}),o=l=>{if(l===p.PACMON){if(n.selectedCoordinate.length>1){u.show({status:j.ERROR,title:"Action Failed",subtitle:"Only one pacmon is allowed"});return}else if(n.hasPacmonInBoard){const t=n.getPacmonCoordinate,{y:r,x:i}=n.selectedCoordinate[0];n.setBoardItem(t,n.board[r][i])}}n.setBulkBoardItem(l),n.clearSelectedCoordinate(),a()};return(l,t)=>(S(),L(F,{duration:250},{default:y(()=>[J(g("div",{ref_key:"wheelMenu",ref:v,class:"absolute",style:I(f(c))},[g("div",de,[g("div",ue,[C(O,{onClick:t[0]||(t[0]=r=>o(f(p).WALL))},{default:y(()=>[me]),_:1}),C(O,{onClick:t[1]||(t[1]=r=>o(f(p).STREET))},{default:y(()=>[fe]),_:1}),C(O,{onClick:t[2]||(t[2]=r=>o(f(p).FOOD))},{default:y(()=>[pe]),_:1}),C(O,{onClick:t[3]||(t[3]=r=>o(f(p).PACMON))},{default:y(()=>[ve]),_:1})]),g("div",{class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 rounded-full bg-gradient-to-r from-rose-400 via-fuchsia-500 to-indigo-500 w-20 h-20 flex justify-center items-center p-1.5 shadow-md",onClick:t[4]||(t[4]=r=>o(f(p).EMPTY))},he)])],4),[[X,f(e)]])]),_:1}))}}),_e=()=>{const h=x(!1),s=n=>{h.value=n.shiftKey};return D(()=>{window.addEventListener("keyup",s),window.addEventListener("keydown",s)}),$(()=>{window.removeEventListener("keyup",s),window.removeEventListener("keydown",s)}),{isShiftKeyPressed:h}},be=h=>{const s=h.value,n=x(null),u=e=>{s.removeEventListener("transitionend",n.value),e()};return{animate:(e,{unmountClass:c}={unmountClass:!1})=>new Promise(a=>{const o=c?"remove":"add";s.classList[o](e),n.value=u.bind(globalThis,a),s.addEventListener("transitionend",n.value)})}},xe={[p.STREET]:K,[p.FOOD]:W,[p.PACMON]:G,[p.WALL]:V};const ye=["data-coordinate"],Ce=["src","alt"],Se=E({props:{coordinate:null,item:null},setup(h){const s=h,n=P(),{isShiftKeyPressed:u}=_e(),v=x(null),e=c=>{if(!n.isAnimating){if(n.isInSelectedCoordinate(c)){n.removeSelectedCoordinate(c);return}u.value?n.setBulkSelectedCoordinate(c):n.setSelectedCoordinate(c)}};return Z(()=>{var c;return(c=n.getCell(s.coordinate))==null?void 0:c.swapDirection},async c=>{if(!v.value||!c)return;const{swap:a,resolve:o}=n.getCell(s.coordinate),{animate:l}=be(v);await l(c),a&&a(),await l(c,{unmountClass:!0}),n.setCellDirection(s.coordinate,null),o&&await o()}),(c,a)=>(S(),k("div",{class:M(["box","select-none","m-1",{"box--active":f(n).isInSelectedCoordinate(s.coordinate)},{"cursor-not-allowed":f(n).isAnimating},{"cursor-pointer":!f(n).isAnimating}]),onClick:a[0]||(a[0]=o=>e(s.coordinate)),"data-coordinate":`${s.coordinate.y}|${s.coordinate.x}`},[C(F,{duration:300},{default:y(()=>[s.item?(S(),k("img",{key:0,class:M(["w-8","h-8","transition-transform","duration-300"]),src:f(xe)[s.item],alt:s.item,ref_key:"box",ref:v},null,8,Ce)):U("",!0)]),_:1})],10,ye))}});var Ae=ie(Se,[["__scopeId","data-v-8b55716e"]]);const ke=h=>{const s=JSON.parse(JSON.stringify(h)),n=([a,o])=>{const l=[[1,0],[-1,0],[0,1],[0,-1]],t=([i,w])=>i>=0&&i<s.length&&w>=0&&w<s[0].length,r=([i,w])=>[p.FOOD,p.STREET,p.PACMON].includes(s[i][w]);return l.map(([i,w])=>[i+a,w+o]).filter(t).filter(r)},u=()=>{for(let a=0;a<s.length;a++)for(let o=0;o<s[a].length;o++)if(s[a][o]===p.PACMON)return[a,o];return null},v=(a,o)=>{var r;const l=[o];let t=o;for(;t;){const i=a.find(w=>w.to.toString()===(t==null?void 0:t.toString()));i&&l.push(i.from),t=(r=i==null?void 0:i.from)!=null?r:null}return l.reverse()},e=(a,o)=>{const l=[],t=new Set,r=[a];for(;r.length;){const i=r.shift();t.add(i.toString());const[w,d]=i,_=o.find(m=>m.id===i.toString());if(s[w][d]===p.FOOD&&!_)return v(l,i);for(const m of n(i))t.has(m.toString())||(l.push({from:i,to:m}),r.push(m))}return null};return(()=>{const a=[];let o=u();if(!o)return[];let l=e(o,a);for(;l;)o=l[l.length-1],a.push({id:o.toString(),path:l}),l=e(o,a);return a})()};const Ee=g("header",{class:"text-center mb-12"},[g("h1",{class:"font-bold text-3xl mb-1"},"Setup your Board"),g("p",{class:"text-gray-400 text-sm"},"Put the obstacle inside the board")],-1),Oe={class:"flex flex-col items-center",ref:"main"},Pe=E({setup(h){const s=.1,n=1e3,u=x(null),v=Q(),e=P(),c=H(),a=T(()=>e.isAnimating?"Resolving...":"Resolve!"),o=x(null);(!e.row||!e.col)&&(c.show({status:j.ERROR,title:"Invalid Row and Column",subtitle:"Invalid Row and Column you will be redirect back",duration:4500}),v.push({name:"Setup"}));const l=T(()=>e.board.reduce((d,_,m)=>(d.push(..._.map((b,A)=>({id:{y:m,x:A},value:b}))),d),[]));D(async()=>{e.isAnimatingInitialAnimation=!0,e.generateBoard(),await N();const d=e.row*e.col*s*n;u.value=setTimeout(()=>e.isAnimatingInitialAnimation=!1,d)});function*t(d){const _=[...d];for(;_.length;)yield _.shift()}const r=(d=500)=>new Promise(_=>setTimeout(_,d)),i=()=>{if(e.isAnimating||e.isAnimatingInitialAnimation)return;const d=ke(e.board);e.generateCells(),console.log(d),o.value=t(d),w()},w=async()=>{e.clearSelectedCoordinate(),e.isAnimating=!0;let d=o.value.next().value;for(;d;){for(let _=0;_<d.path.length;_++){if(_===d.path.length-1)continue;const[m,b]=d.path[_],[A,B]=d.path[_+1],Y=e.board[m][b],R=e.board[A][B];e.swapCell({currentCoordinate:{y:m,x:b},nextCoordinate:{y:A,x:B}}),e.setCell({y:m,x:b},"swap",()=>{e.setCell({y:m,x:b},"swap",null),e.setBoardItem({y:m,x:b},R===p.FOOD?p.STREET:R),e.setBoardItem({y:A,x:B},Y)}),await new Promise(z=>{e.setCell({y:m,x:b},"resolve",async()=>{e.setCell({y:m,x:b},"resolve",null),await r(0),z()})})}d=o.value.next().value}e.isAnimating=!1};return $(()=>{e.resetBoard(),u.value&&clearTimeout(u.value)}),(d,_)=>(S(),k("section",null,[Ee,g("main",Oe,[g("div",{class:"grid",style:I({gridTemplateColumns:`repeat(${f(e).col}, minmax(0, 1fr))`,gridTemplateRows:`repeat(${f(e).row}, minmax(0, 1fr))`})},[C(ee,{name:"fade"},{default:y(()=>[(S(!0),k(te,null,ne(f(l),(m,b)=>(S(),L(Ae,{key:b,coordinate:m.id,item:m.value,style:I({"--transitionDelay":`${b*s}s`})},null,8,["coordinate","item","style"]))),128))]),_:1})],4)],512),C(ae,{classNames:["mx-auto","mt-12"],disabled:f(e).isAnimating||f(e).isAnimatingInitialAnimation,onClick:i},{default:y(()=>[se(oe(f(a)),1)]),_:1},8,["disabled"]),C(we,{visible:!1})]))}});export{Pe as default};
