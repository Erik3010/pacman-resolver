import{d as E,o as A,c as B,b as v,r as Z,x as y,y as O,z as R,A as M,f as H,w as x,B as U,C as Q,u as h,e as C,D as N,E as F,G as ee,q as j,h as te,s as ne,H as se,F as oe,I as ae,a as ie,i as re}from"./vendor.cfaae494.js";import{B as le}from"./Button.464f4e25.js";import{u as V,Z as K,N as W,_ as ce}from"./index.441c6243.js";import{u as L,B as m}from"./board.8560589b.js";var G="/pacman-resolver/assets/wall.d1eeac38.png",J="/pacman-resolver/assets/street.a943c8c6.png",Y="/pacman-resolver/assets/food.37631a6a.png",z="/pacman-resolver/assets/pacmon.cddf7029.png",de="/pacman-resolver/assets/remove.b16c524a.png";const ue={class:"absolute flex justify-center items-center w-full h-full transform -rotate-45 text-2xl select-none"},T=E({emits:["click"],setup(p,{emit:s}){return(n,d)=>(A(),B("div",{class:"relative cursor-pointer transition hover:bg-gray-800",onClick:d[0]||(d[0]=f=>s("click"))},[v("div",ue,[Z(n.$slots,"default")])]))}}),me=({element:p,initialVisible:s,cantOpenContextMenu:n})=>{const d=y(s||!1),f=y({top:0,left:0}),e=O(()=>{const{top:t,left:i}=f.value;return{top:`${t}px`,left:`${i}px`}}),c=t=>{const i=p.value,r=i.clientHeight,g=i.clientWidth;t.top+r>=window.innerHeight&&(t.top-=r),t.left+g>=window.innerWidth&&(t.left-=g),f.value=t},o=()=>d.value=!1,a=t=>{if(t.stopPropagation(),!d.value)return;const i=t.target;!p.value.contains(i)&&o()},l=async t=>{if(t.preventDefault(),n())return;const i={top:t.pageY,left:t.pageX};d.value&&o(),await M(),d.value=!0,c(i)};return window.addEventListener("click",a),window.addEventListener("contextmenu",l),R(()=>window.removeEventListener("contextmenu",l)),{isVisible:d,position:f,positionStyle:e,closeContextMenu:o}},fe={class:"relative select-none"},ve={class:"border-2 border-blue-300 bg-gray-900 rounded-full w-52 h-52 grid grid-cols-2 grid-rows-2 transform rotate-45 overflow-hidden shadow-xl shadow-gray-900 divide-gray-700 divide-x divide-y"},pe=v("img",{src:G,class:"w-9 h-9"},null,-1),ge=v("img",{src:J,class:"w-9 h-9"},null,-1),he=v("img",{src:Y,class:"w-9 h-9"},null,-1),we=v("img",{src:z,class:"w-9 h-9"},null,-1),_e=v("div",{class:"rounded-full w-full h-full bg-gray-800 cursor-pointer flex justify-center items-center text-2xl hover:bg-gray-700"},[v("img",{src:de,class:"w-7 h-7"})],-1),be=[_e],ye=E({props:{visible:null},setup(p){const s=p,n=L(),d=V(),f=y(null),{isVisible:e,positionStyle:c,closeContextMenu:o}=me({element:f,initialVisible:s.visible,cantOpenContextMenu:()=>n.isAnimating||n.isAnimatingInitialAnimation||!n.hasSelectedCoordinate}),a=l=>{if(l===m.PACMON){if(n.selectedCoordinate.length>1){d.show({status:W.ERROR,title:"Action Failed",subtitle:"Only one pacmon is allowed"});return}else if(n.hasPacmonInBoard){const t=n.getPacmonCoordinate,{y:i,x:r}=n.selectedCoordinate[0];n.setBoardItem(t,n.board[i][r])}}n.setBulkBoardItem(l),n.clearSelectedCoordinate(),o()};return(l,t)=>(A(),H(K,{duration:250},{default:x(()=>[U(v("div",{ref_key:"wheelMenu",ref:f,class:"absolute",style:N(h(c))},[v("div",fe,[v("div",ve,[C(T,{onClick:t[0]||(t[0]=i=>a(h(m).WALL))},{default:x(()=>[pe]),_:1}),C(T,{onClick:t[1]||(t[1]=i=>a(h(m).STREET))},{default:x(()=>[ge]),_:1}),C(T,{onClick:t[2]||(t[2]=i=>a(h(m).FOOD))},{default:x(()=>[he]),_:1}),C(T,{onClick:t[3]||(t[3]=i=>a(h(m).PACMON))},{default:x(()=>[we]),_:1})]),v("div",{class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 rounded-full bg-gradient-to-r from-rose-400 via-fuchsia-500 to-indigo-500 w-20 h-20 flex justify-center items-center p-1.5 shadow-md",onClick:t[4]||(t[4]=i=>a(h(m).EMPTY))},be)])],4),[[Q,h(e)]])]),_:1}))}}),xe=()=>{const p=y(!1),s=n=>{p.value=n.shiftKey};return F(()=>{window.addEventListener("keyup",s),window.addEventListener("keydown",s)}),R(()=>{window.removeEventListener("keyup",s),window.removeEventListener("keydown",s)}),{isShiftKeyPressed:p}},Ce=p=>{const s=p.value,n=y(null),d=e=>{s.removeEventListener("transitionend",n.value),e()};return{animate:(e,{unmountClass:c}={unmountClass:!1})=>new Promise(o=>{const a=c?"remove":"add";s.classList[a](e),n.value=d.bind(globalThis,o),s.addEventListener("transitionend",n.value)})}},Se={[m.STREET]:J,[m.FOOD]:Y,[m.PACMON]:z,[m.WALL]:G};const Ae=["data-coordinate"],ke=["src","alt"],Be=E({props:{coordinate:null,item:null},setup(p){const s=p,n=L(),{isShiftKeyPressed:d}=xe(),f=y(null),e=c=>{if(!n.isAnimating){if(n.isInSelectedCoordinate(c)){n.removeSelectedCoordinate(c);return}d.value?n.setBulkSelectedCoordinate(c):n.setSelectedCoordinate(c)}};return ee(()=>{var c;return(c=n.getCell(s.coordinate))==null?void 0:c.swapDirection},async c=>{if(!f.value||!c)return;const{swap:o,resolve:a}=n.getCell(s.coordinate),{animate:l}=Ce(f);await l(c),o&&o(),await l(c,{unmountClass:!0}),n.setCellDirection(s.coordinate,null),a&&await a()}),(c,o)=>(A(),B("div",{class:j(["box","select-none","m-1",{"box--active":h(n).isInSelectedCoordinate(s.coordinate)},{"cursor-not-allowed":h(n).isAnimating},{"cursor-pointer":!h(n).isAnimating}]),onClick:o[0]||(o[0]=a=>e(s.coordinate)),"data-coordinate":`${s.coordinate.y}|${s.coordinate.x}`},[C(K,{duration:300},{default:x(()=>[s.item?(A(),B("img",{key:0,class:j(["w-8","h-8","transition-transform","duration-300"]),src:h(Se)[s.item],alt:s.item,ref_key:"box",ref:f},null,8,ke)):te("",!0)]),_:1})],10,Ae))}});var Oe=ce(Be,[["__scopeId","data-v-8b55716e"]]);const Ee=p=>{const s=JSON.parse(JSON.stringify(p)),n=([o,a])=>{const l=[[1,0],[-1,0],[0,1],[0,-1]],t=([r,g])=>r>=0&&r<s.length&&g>=0&&g<s[0].length,i=([r,g])=>[m.FOOD,m.STREET,m.PACMON].includes(s[r][g]);return l.map(([r,g])=>[r+o,g+a]).filter(t).filter(i)},d=()=>{for(let o=0;o<s.length;o++)for(let a=0;a<s[o].length;a++)if(s[o][a]===m.PACMON)return[o,a];return null},f=(o,a)=>{var i;const l=[a];let t=a;for(;t;){const r=o.find(g=>g.to.toString()===(t==null?void 0:t.toString()));r&&l.push(r.from),t=(i=r==null?void 0:r.from)!=null?i:null}return l.reverse()},e=(o,a)=>{const l=[],t=new Set,i=[o];for(;i.length;){const r=i.shift();t.add(r.toString());const[g,$]=r,I=a.find(S=>S.id===r.toString());if(s[g][$]===m.FOOD&&!I)return f(l,r);for(const S of n(r))t.has(S.toString())||(l.push({from:r,to:S}),i.push(S))}return null};return(()=>{const o=[];let a=d();if(!a)return[];let l=e(a,o);for(;l;)a=l[l.length-1],o.push({id:a.toString(),path:l}),l=e(a,o);return o})()};const Te=v("header",{class:"text-center mb-12"},[v("h1",{class:"font-bold text-3xl mb-1"},"Setup your Board"),v("p",{class:"text-gray-400 text-sm"},"Put the obstacle inside the board")],-1),$e={class:"flex flex-col items-center",ref:"main"},Le=E({setup(p){const s=.1,n=1e3,d=y(null),f=ne(),e=L(),c=V(),o=y([]),a=O(()=>e.isAnimating?"Resolving...":"Resolve!"),l=O(()=>({gridTemplateColumns:`repeat(${e.col}, minmax(0, 1fr))`,gridTemplateRows:`repeat(${e.row}, minmax(0, 1fr))`})),t=O(()=>e.isAnimating||e.isAnimatingInitialAnimation||e.isBoardHasEmptyCell),i=y(null);(!e.row||!e.col)&&(c.show({status:W.ERROR,title:"Invalid Row and Column",subtitle:"Invalid Row and Column you will be redirect back",duration:4500}),f.push({name:"Setup"}));const r=O(()=>e.board.reduce((u,w,_)=>(u.push(...w.map((b,k)=>({id:{y:_,x:k},value:b}))),u),[]));F(async()=>{e.isAnimatingInitialAnimation=!0,e.generateBoard(),await M();const u=e.row*e.col*s*n;d.value=setTimeout(()=>e.isAnimatingInitialAnimation=!1,u)});function*g(u){const w=[...u];for(;w.length;)yield w.shift()}const $=(u=500)=>new Promise(w=>setTimeout(w,u)),I=()=>{if(e.isAnimating||e.isAnimatingInitialAnimation)return;o.value=JSON.parse(JSON.stringify(e.board));const u=Ee(e.board);e.generateCells(),console.log(u),i.value=g(u),S()},S=async()=>{e.clearSelectedCoordinate(),e.isAnimating=!0;let u=i.value.next().value;for(;u;){for(let w=0;w<u.path.length;w++){if(w===u.path.length-1)continue;const[_,b]=u.path[w],[k,P]=u.path[w+1],q=e.board[_][b],D=e.board[k][P];e.swapCell({currentCoordinate:{y:_,x:b},nextCoordinate:{y:k,x:P}}),e.setCell({y:_,x:b},"swap",()=>{e.setCell({y:_,x:b},"swap",null),e.setBoardItem({y:_,x:b},D===m.FOOD?m.STREET:D),e.setBoardItem({y:k,x:P},q)}),await new Promise(X=>{e.setCell({y:_,x:b},"resolve",async()=>{e.setCell({y:_,x:b},"resolve",null),await $(0),X()})})}u=i.value.next().value}e.isAnimating=!1,console.log(o.value)};return R(()=>{e.resetBoard(),d.value&&clearTimeout(d.value)}),(u,w)=>(A(),B("section",null,[Te,v("main",$e,[v("div",{class:"grid",style:N(h(l))},[C(se,{name:"fade"},{default:x(()=>[(A(!0),B(oe,null,ae(h(r),(_,b)=>(A(),H(Oe,{key:b,coordinate:_.id,item:_.value,style:N({"--transitionDelay":`${b*s}s`})},null,8,["coordinate","item","style"]))),128))]),_:1})],4)],512),C(le,{classNames:["mx-auto","mt-12"],onClick:I,disabled:h(t)},{default:x(()=>[ie(re(h(a)),1)]),_:1},8,["disabled"]),C(ye,{visible:!1})]))}});export{Le as default};
